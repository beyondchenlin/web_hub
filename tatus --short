warning: in the working copy of 'config/forum_settings.yaml', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'shared/forum_config.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/.env.example', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/aicut_forum_crawler.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/aicut_lrtcai_config.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/cluster_monitor/config.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/cluster_monitor/simple_forum_crawler.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/lightweight/forum_integration.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'web_hub/start_lightweight.py', LF will be replaced by CRLF the next time Git touches it
[1mdiff --git a/config/forum_settings.yaml b/config/forum_settings.yaml[m
[1mindex 9695e60..6959d1c 100644[m
[1m--- a/config/forum_settings.yaml[m
[1m+++ b/config/forum_settings.yaml[m
[36m@@ -2,6 +2,3 @@[m [mforum:[m
   base_url: https://tts.lrtcai.com[m
   target_url: https://tts.lrtcai.com/forum-2-1.html[m
   forum_id: 2[m
[31m-credentials:[m
[31m-  username: AIå‰ªè¾‘åŠ©æ‰‹[m
[31m-  password: 594188@lrtcai[m
[1mdiff --git a/shared/forum_config.py b/shared/forum_config.py[m
[1mindex 6567aac..1fb72a2 100644[m
[1m--- a/shared/forum_config.py[m
[1m+++ b/shared/forum_config.py[m
[36m@@ -71,7 +71,7 @@[m [mdef load_forum_settings(config_path: str | Path | None = None) -> Dict[str, Any][m
     if "forum" not in config:[m
         config["forum"] = {}[m
     if "credentials" not in config:[m
[31m-        config["credentials"] = {}[m
[32m+[m[32m        config["credentials"] = {}  # YAMLä¸­ä¸åº”åŒ…å«credentialsï¼Œä».envè¯»å–[m
 [m
     config = _merge_env_overrides(config)[m
 [m
[1mdiff --git a/web_hub/.env.example b/web_hub/.env.example[m
[1mindex e3d9155..f680b13 100644[m
[1m--- a/web_hub/.env.example[m
[1m+++ b/web_hub/.env.example[m
[36m@@ -57,15 +57,22 @@[m [mK8S_SERVICE_NAME=video-processor[m
 K8S_CLUSTER_NAME=video-cluster[m
 [m
 # ===========================================[m
[31m-# è®ºå›é›†æˆé…ç½® - ç»Ÿä¸€é…ç½®æº[m
[32m+[m[32m# è®ºå›é›†æˆé…ç½®[m
 # ===========================================[m
[32m+[m[32m# ğŸ”§ åŸºç¡€é…ç½®[m
[32m+[m[32m# FORUM_ENABLED - å¯ç”¨è®ºå›ç›‘æ§åŠŸèƒ½[m
[32m+[m[32m# FORUM_CHECK_INTERVAL - æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰[m
 FORUM_ENABLED=true[m
[31m-FORUM_CHECK_INTERVAL=10                                    # ç»Ÿä¸€ä¸º10ç§’é«˜é¢‘ç›‘æ§[m
[31m-FORUM_BASE_URL=https://tts.lrtcai.com[m
[31m-FORUM_TARGET_URL=https://tts.lrtcai.com/forum-2-1.html[m
[31m-FORUM_USERNAME=AIå‰ªè¾‘åŠ©æ‰‹                                   # è¯·ä¿®æ”¹ä¸ºæ‚¨çš„è®ºå›ç”¨æˆ·å[m
[31m-FORUM_PASSWORD=594188@lrtcai                               # è¯·ä¿®æ”¹ä¸ºæ‚¨çš„è®ºå›å¯†ç [m
[31m-FORUM_TARGET_FORUM_ID=2[m
[32m+[m[32mFORUM_CHECK_INTERVAL=10[m
[32m+[m
[32m+[m[32m# ğŸŒ è®ºå›è´¦å·é…ç½®[m
[32m+[m[32m# è®ºå›åœ°å€åœ¨ config/forum_settings.yaml ä¸­é…ç½®[m
[32m+[m[32m# FORUM_USERNAME - è®ºå›ç”¨æˆ·å[m
[32m+[m[32m# FORUM_PASSWORD - è®ºå›å¯†ç [m
[32m+[m[32mFORUM_USERNAME=AIå‰ªè¾‘åŠ©æ‰‹[m
[32m+[m[32mFORUM_PASSWORD=your-password-here[m
[32m+[m
[32m+[m[32m# âš™ï¸ åŠŸèƒ½é…ç½®[m
 FORUM_AUTO_REPLY_ENABLED=true[m
 FORUM_TEST_MODE=false[m
 [m
[1mdiff --git a/web_hub/aicut_forum_crawler.py b/web_hub/aicut_forum_crawler.py[m
[1mindex 3c419dc..0627bf0 100644[m
[1m--- a/web_hub/aicut_forum_crawler.py[m
[1m+++ b/web_hub/aicut_forum_crawler.py[m
[36m@@ -12,6 +12,7 @@[m
 import os[m
 import re[m
 import json[m
[32m+[m[32mimport sys[m
 import time[m
 import requests[m
 from bs4 import BeautifulSoup[m
[36m@@ -39,8 +40,8 @@[m [mclass AicutForumCrawler:[m
         credentials_cfg = settings.get("credentials", {})[m
 [m
         # å…è®¸å¤–éƒ¨å‚æ•°æˆ–ç¯å¢ƒå˜é‡è¦†ç›–[m
[31m-        self.base_url = base_url or os.getenv('FORUM_BASE_URL', forum_cfg.get("base_url", "https://tts.lrtcai.com"))[m
[31m-        self.forum_url = forum_url or os.getenv('FORUM_TARGET_URL', forum_cfg.get("target_url", "https://tts.lrtcai.com/forum-2-1.html"))[m
[32m+[m[32m        self.base_url = base_url or os.getenv('FORUM_BASE_URL') or forum_cfg["base_url"][m
[32m+[m[32m        self.forum_url = forum_url or os.getenv('FORUM_TARGET_URL') or forum_cfg["target_url"][m
 [m
         self.username = ([m
             username or[m
[36m@@ -611,34 +612,38 @@[m [mclass AicutForumCrawler:[m
         """æå–å°é¢ä¿¡æ¯ - ä½¿ç”¨ç»Ÿä¸€çš„up/downå‡½æ•°"""[m
         cover_info = {}[m
 [m
[31m-        # ğŸ¯ ä½¿ç”¨ç»Ÿä¸€çš„å°é¢æ ‡é¢˜æå–å‡½æ•°[m
[31m-        from pre.stage.unified_content_processor import extract_cover_title_up, extract_cover_title_middle, extract_cover_title_down[m
[31m-[m
[31m-        # æå–å°é¢æ ‡é¢˜ä¸Šã€ä¸­ã€ä¸‹[m
[31m-        cover_title_up = extract_cover_title_up(content)[m
[31m-        cover_title_middle = extract_cover_title_middle(content)[m
[31m-        cover_title_down = extract_cover_title_down(content)[m
[31m-[m
[31m-        # ğŸ¯ ä½¿ç”¨ç»Ÿä¸€çš„up/middle/downå­—æ®µåï¼Œåªä¿å­˜å’Œæ˜¾ç¤ºæœ‰å†…å®¹çš„æ ‡é¢˜[m
[31m-        extracted_titles = [][m
[31m-[m
[31m-        if cover_title_up:[m
[31m-            cover_info['cover_title_up'] = cover_title_up[m
[31m-            extracted_titles.append(f"ä¸Šæ ‡é¢˜: '{cover_title_up}'")[m
[31m-[m
[31m-        if cover_title_middle:[m
[31m-            cover_info['cover_title_middle'] = cover_title_middle[m
[31m-            extracted_titles.append(f"ä¸­æ ‡é¢˜: '{cover_title_middle}'")[m
[31m-[m
[31m-        if cover_title_down:[m
[31m-            cover_info['cover_title_down'] = cover_title_down[m
[31m-            extracted_titles.append(f"ä¸‹æ ‡é¢˜: '{cover_title_down}'")[m
[31m-[m
[31m-        # ç»Ÿä¸€æ˜¾ç¤ºæå–åˆ°çš„æ ‡é¢˜[m
[31m-        if extracted_titles:[m
[31m-            print("ğŸ“ æå–åˆ°çš„å°é¢æ ‡é¢˜:")[m
[31m-            for title in extracted_titles:[m
[31m-                print(f"   {title}")[m
[32m+[m[32m        try:[m
[32m+[m[32m            # ğŸ¯ ä½¿ç”¨ç»Ÿä¸€çš„å°é¢æ ‡é¢˜æå–å‡½æ•°ï¼ˆè§†é¢‘å¤„ç†æ¨¡å—ï¼ŒTTSç³»ç»Ÿå¯é€‰ï¼‰[m
[32m+[m[32m            from pre.stage.unified_content_processor import extract_cover_title_up, extract_cover_title_middle, extract_cover_title_down[m
[32m+[m
[32m+[m[32m            # æå–å°é¢æ ‡é¢˜ä¸Šã€ä¸­ã€ä¸‹[m
[32m+[m[32m            cover_title_up = extract_cover_title_up(content)[m
[32m+[m[32m            cover_title_middle = extract_cover_title_middle(content)[m
[32m+[m[32m            cover_title_down = extract_cover_title_down(content)[m
[32m+[m
[32m+[m[32m            # ğŸ¯ ä½¿ç”¨ç»Ÿä¸€çš„up/middle/downå­—æ®µåï¼Œåªä¿å­˜å’Œæ˜¾ç¤ºæœ‰å†…å®¹çš„æ ‡é¢˜[m
[32m+[m[32m            extracted_titles = [][m
[32m+[m
[32m+[m[32m            if cover_title_up:[m
[32m+[m[32m                cover_info['cover_title_up'] = cover_title_up[m
[32m+[m[32m                extracted_titles.append(f"ä¸Šæ ‡é¢˜: '{cover_title_up}'")[m
[32m+[m
[32m+[m[32m            if cover_title_middle:[m
[32m+[m[32m                cover_info['cover_title_middle'] = cover_title_middle[m
[32m+[m[32m                extracted_titles.append(f"ä¸­æ ‡é¢˜: '{cover_title_middle}'")[m
[32m+[m
[32m+[m[32m            if cover_title_down:[m
[32m+[m[32m                cover_info['cover_title_down'] = cover_title_down[m
[32m+[m[32m                extracted_titles.append(f"ä¸‹æ ‡é¢˜: '{cover_title_down}'")[m
[32m+[m
[32m+[m[32m            # ç»Ÿä¸€æ˜¾ç¤ºæå–åˆ°çš„æ ‡é¢˜[m
[32m+[m[32m            if extracted_titles:[m
[32m+[m[32m                print("ğŸ“ æå–åˆ°çš„å°é¢æ ‡é¢˜:")[m
[32m+[m[32m                for title in extracted_titles:[m
[32m+[m[32m                    print(f"   {title}")[m
[32m+[m[32m        except ImportError:[m
[32m+[m[32m            # TTSç³»ç»Ÿä¸éœ€è¦è§†é¢‘å¤„ç†æ¨¡å—ï¼Œè·³è¿‡å°é¢æ ‡é¢˜æå–[m
[32m+[m[32m            pass[m
 [m
         return cover_info[m
 [m
[1mdiff --git a/web_hub/aicut_lrtcai_config.py b/web_hub/aicut_lrtcai_config.py[m
[1mindex f4fa127..13c3f5d 100644[m
[1m--- a/web_hub/aicut_lrtcai_config.py[m
[1m+++ b/web_hub/aicut_lrtcai_config.py[m
[36m@@ -28,17 +28,17 @@[m [mclass AicutLrtcaiConfig:[m
     [m
     # ç½‘ç«™åŸºæœ¬ä¿¡æ¯ - ä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œç»Ÿä¸€é…ç½®æº[m
     site_name: str = "æ‡’äººåŒåŸå·AI-æ™ºèƒ½å‰ªå£æ’­"[m
[31m-    site_url: str = field(default_factory=lambda: load_forum_settings()["forum"].get("base_url", "https://tts.lrtcai.com") + "/")[m
[32m+[m[32m    site_url: str = field(default_factory=lambda: load_forum_settings()["forum"]["base_url"] + "/")[m
     site_type: str = "discuz"[m
     site_version: str = "X3.5"[m
 [m
     # è®ºå›é…ç½® - ä»ç¯å¢ƒå˜é‡è¯»å–[m
[31m-    forum_url: str = field(default_factory=lambda: load_forum_settings()["forum"].get("base_url", "https://tts.lrtcai.com") + "/forum.php")[m
[31m-    mobile_url: str = field(default_factory=lambda: load_forum_settings()["forum"].get("base_url", "https://tts.lrtcai.com") + "/forum.php?mobile=yes")[m
[32m+[m[32m    forum_url: str = field(default_factory=lambda: load_forum_settings()["forum"]["base_url"] + "/forum.php")[m
[32m+[m[32m    mobile_url: str = field(default_factory=lambda: load_forum_settings()["forum"]["base_url"] + "/forum.php?mobile=yes")[m
 [m
     # ç›®æ ‡ç›‘æ§æ¿å— - ä»ç¯å¢ƒå˜é‡è¯»å–[m
[31m-    target_forum_id: int = field(default_factory=lambda: load_forum_settings()["forum"].get("forum_id", 2))[m
[31m-    target_forum_url: str = field(default_factory=lambda: load_forum_settings()["forum"].get("target_url", "https://tts.lrtcai.com/forum-2-1.html"))[m
[32m+[m[32m    target_forum_id: int = field(default_factory=lambda: load_forum_settings()["forum"]["forum_id"])[m
[32m+[m[32m    target_forum_url: str = field(default_factory=lambda: load_forum_settings()["forum"]["target_url"])[m
     target_forum_name: str = "æ™ºèƒ½å‰ªå£æ’­"[m
 [m
     # ç™»å½•é…ç½® - ä»ç¯å¢ƒå˜é‡è¯»å–[m
[1mdiff --git a/web_hub/cluster_monitor/.env.template b/web_hub/cluster_monitor/.env.template[m
[1mindex 04cc365..bb76c19 100644[m
[1m--- a/web_hub/cluster_monitor/.env.template[m
[1m+++ b/web_hub/cluster_monitor/.env.template[m
[36m@@ -27,37 +27,13 @@[m [mMACHINES_CONFIG_FILE=machines.txt[m
 WEB_REFRESH_INTERVAL=10[m
 [m
 # ===========================================[m
[31m-# è®ºå›ç›‘æ§é…ç½®ï¼ˆç‹¬ç«‹è¿è¡Œå¿…éœ€ï¼‰[m
[32m+[m[32m# é…ç½®è¯´æ˜[m[41m[m
[32m+[m[32m# ===========================================[m[41m[m
[32m+[m[32m# æ³¨æ„ï¼šcluster_monitor åº”è¯¥ä»çˆ¶ç›®å½• web_hub/.env è¯»å–é…ç½®[m[41m[m
[32m+[m[32m# è®ºå›URLã€ç”¨æˆ·åå¯†ç ç­‰åº”åœ¨ web_hub/.env ä¸­é…ç½®[m[41m[m
[32m+[m[32m# è®ºå›åœ°å€åœ¨ config/forum_settings.yaml ä¸­é…ç½®[m[41m[m
[32m+[m[32m# æ­¤æ–‡ä»¶ä»…ç”¨äº cluster_monitor ç‰¹å®šçš„é…ç½®è¦†ç›–ï¼ˆå¦‚æœéœ€è¦ï¼‰[m[41m[m
 # ===========================================[m
[31m-[m
[31m-# ğŸ”§ åŸºç¡€é…ç½®[m
[31m-FORUM_ENABLED=true[m
[31m-FORUM_CHECK_INTERVAL=10[m
[31m-[m
[31m-# ğŸŒ è®ºå›ç½‘ç«™é…ç½®[m
[31m-FORUM_BASE_URL=https://tts.lrtcai.com[m
[31m-FORUM_TARGET_URL=https://tts.lrtcai.com/forum-2-1.html[m
[31m-[m
[31m-# ğŸ”’ æ•æ„Ÿä¿¡æ¯é…ç½®ï¼ˆè¯·ä¿®æ”¹ä¸ºå®é™…å€¼ï¼‰[m
[31m-FORUM_USERNAME=your_username_here[m
[31m-FORUM_PASSWORD=your_secure_password_here[m
[31m-[m
[31m-FORUM_TARGET_FORUM_ID=2[m
[31m-[m
[31m-# âš™ï¸ åŠŸèƒ½é…ç½®[m
[31m-FORUM_AUTO_REPLY_ENABLED=true[m
[31m-FORUM_TEST_MODE=false[m
[31m-FORUM_TEST_ONCE=false[m
[31m-[m
[31m-# ğŸ”„ å…¼å®¹æ€§é…ç½®ï¼ˆæ”¯æŒå¤šç§ç¯å¢ƒå˜é‡åï¼‰[m
[31m-AICUT_ADMIN_USERNAME=your_username_here[m
[31m-AICUT_ADMIN_PASSWORD=your_secure_password_here[m
[31m-[m
[31m-# ğŸ•·ï¸ çˆ¬è™«æ¨¡å¼é…ç½®[m
[31m-CRAWLER_MODE=PRODUCTION[m
[31m-MIN_CHECK_INTERVAL=10[m
[31m-MAX_CHECK_INTERVAL=10[m
[31m-MAX_POSTS_TO_PROCESS=50[m
 [m
 # ===========================================[m
 # å®‰å…¨è¯´æ˜[m
[36m@@ -67,4 +43,4 @@[m [mMAX_POSTS_TO_PROCESS=50[m
 # 3. ç¡®ä¿å¯†ç å¼ºåº¦ï¼šè‡³å°‘8ä½ï¼ŒåŒ…å«å­—æ¯æ•°å­—ç»„åˆ[m
 # 4. ä¸è¦å°† .env æ–‡ä»¶æäº¤åˆ°ä»£ç ä»“åº“[m
 # 5. å®šæœŸæ›´æ¢å¯†ç æé«˜å®‰å…¨æ€§[m
[31m-# ===========================================[m
[32m+[m[32m# ===========================================[m[41m[m
[1mdiff --git a/web_hub/cluster_monitor/config.py b/web_hub/cluster_monitor/config.py[m
[1mindex 92eb099..edf5d9d 100644[m
[1m--- a/web_hub/cluster_monitor/config.py[m
[1m+++ b/web_hub/cluster_monitor/config.py[m
[36m@@ -5,9 +5,19 @@[m
 [m
 import os[m
 import sys[m
[32m+[m[32mimport io[m
 from pathlib import Path[m
 from dotenv import load_dotenv[m
 [m
[32m+[m[32m# Fix Windows console encoding for emoji support[m
[32m+[m[32mif sys.platform == 'win32':[m
[32m+[m[32m    try:[m
[32m+[m[32m        sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8', errors='replace')[m
[32m+[m[32m        sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8', errors='replace')[m
[32m+[m[32m    except (AttributeError, io.UnsupportedOperation):[m
[32m+[m[32m        # If stdout/stderr don't have buffer attribute, skip[m
[32m+[m[32m        pass[m
[32m+[m
 # ç¡®ä¿ shared å¯å¯¼å…¥[m
 REPO_ROOT = Path(__file__).resolve().parents[2][m
 if str(REPO_ROOT) not in sys.path:[m
[36m@@ -32,11 +42,11 @@[m [mclass MonitorConfig:[m
         forum_cfg = forum_settings.get('forum', {})[m
         credentials_cfg = forum_settings.get('credentials', {})[m
 [m
[31m-        self.FORUM_BASE_URL = os.getenv('FORUM_BASE_URL', forum_cfg.get('base_url', 'https://tts.lrtcai.com'))[m
[31m-        self.FORUM_TARGET_URL = os.getenv('FORUM_TARGET_URL', forum_cfg.get('target_url', 'https://tts.lrtcai.com/forum-2-1.html'))[m
[32m+[m[32m        self.FORUM_BASE_URL = os.getenv('FORUM_BASE_URL') or forum_cfg["base_url"][m
[32m+[m[32m        self.FORUM_TARGET_URL = os.getenv('FORUM_TARGET_URL') or forum_cfg["target_url"][m
         self.FORUM_USERNAME = os.getenv('FORUM_USERNAME', os.getenv('AICUT_ADMIN_USERNAME', credentials_cfg.get('username', '')))[m
         self.FORUM_PASSWORD = os.getenv('FORUM_PASSWORD', os.getenv('AICUT_ADMIN_PASSWORD', credentials_cfg.get('password', '')))[m
[31m-        self.FORUM_TARGET_FORUM_ID = int(os.getenv('FORUM_TARGET_FORUM_ID', forum_cfg.get('forum_id', 2)))[m
[32m+[m[32m        self.FORUM_TARGET_FORUM_ID = int(os.getenv('FORUM_TARGET_FORUM_ID') or forum_cfg["forum_id"])[m
 [m
         # è®ºå›åŠŸèƒ½é…ç½®[m
         self.FORUM_AUTO_REPLY_ENABLED = os.getenv('FORUM_AUTO_REPLY_ENABLED', 'true').lower() == 'true'[m
[1mdiff --git a/web_hub/cluster_monitor/forum_monitor.py b/web_hub/cluster_monitor/forum_monitor.py[m
[1mindex 62b8943..386a4cf 100644[m
[1m--- a/web_hub/cluster_monitor/forum_monitor.py[m
[1m+++ b/web_hub/cluster_monitor/forum_monitor.py[m
[36m@@ -23,7 +23,7 @@[m [mimport logging[m
 [m
 from shared.forum_config import load_forum_settings[m
 from shared.task_model import TaskType[m
[31m-from lightweight.queue_manager import QueueManager[m
[32m+[m[32mfrom web_hub.lightweight.queue_manager import QueueManager[m[41m[m
 [m
 # æ·»åŠ å½“å‰ç›®å½•åˆ°è·¯å¾„[m
 sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))[m
[1mdiff --git a/web_hub/cluster_monitor/simple_forum_crawler.py b/web_hub/cluster_monitor/simple_forum_crawler.py[m
[1mindex f810df6..15a3757 100644[m
[1m--- a/web_hub/cluster_monitor/simple_forum_crawler.py[m
[1m+++ b/web_hub/cluster_monitor/simple_forum_crawler.py[m
[36m@@ -35,8 +35,8 @@[m [mclass SimpleForumCrawler:[m
         forum_cfg = settings.get('forum', {})[m
         credentials_cfg = settings.get('credentials', {})[m
 [m
[31m-        self.base_url = base_url or os.getenv('FORUM_BASE_URL', forum_cfg.get('base_url', "https://tts.lrtcai.com"))[m
[31m-        self.forum_url = forum_url or os.getenv('FORUM_TARGET_URL', forum_cfg.get('target_url', "https://tts.lrtcai.com/forum-2-1.html"))[m
[32m+[m[32m        self.base_url = base_url or os.getenv('FORUM_BASE_URL') or forum_cfg["base_url"][m
[32m+[m[32m        self.forum_url = forum_url or os.getenv('FORUM_TARGET_URL') or forum_cfg["target_url"][m
         [m
         # è®ºå›è´¦å·ä¿¡æ¯[m
         self.username = ([m
[1mdiff --git a/web_hub/lightweight/forum_integration.py b/web_hub/lightweight/forum_integration.py[m
[1mindex e6a21d8..3a6fecb 100644[m
[1m--- a/web_hub/lightweight/forum_integration.py[m
[1m+++ b/web_hub/lightweight/forum_integration.py[m
[36m@@ -99,8 +99,8 @@[m [mclass ForumIntegration:[m
                 # è·å–è®ºå›URLé…ç½®[m
                 settings = load_forum_settings()[m
                 forum_cfg = settings.get('forum', {})[m
[31m-                base_url = os.getenv('FORUM_BASE_URL', forum